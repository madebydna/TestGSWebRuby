
<% city = CityHomeDecorator.decorate(@city_object) %>

<div class="limit-width-1200">
  <%= render 'nav/breadcrumbs', breadcrumbs: @breadcrumbs, top_margin: 'mtl' %>
  <h1 class="notranslate"><%= city.name %> Schools</h1>


  <% # Row contains rating, boilerplate text (description of city), %>
  <% # and an advertisement %>
  <div class="row phm">
    <% if @show_ads %>
      <% first_column_sizes = "col-lg-8 col-md-7 col-sm-6 col-xs-12" %>
      <% second_column_sizes = "col-lg-4 col-md-5 col-sm-6 col-xs-12" %>
    <% else %>
      <% first_column_sizes = "col-xs-12" %>
    <% end %>

    <div class="<%= first_column_sizes %> prm ptm">
      <div class="row">
        <div class="col-xs-12">
          <div class="clearfix city-district-banner-width rs-city-rating">
            <%= city.square_rating(@city_rating, class: 'fl') %>
            <div class="fl pal tal">
              <span class="font-size-large">GreatSchools</span><br/>
              <span class="font-size-xl">City rating</span>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        This city's rating is based on its schools' test results.
        <%= link_to 'Learn more &raquo;'.html_safe, how_we_rate_schools_path %></p>
      </div>

      <% # Row contains links / buttons to browse schools by level %>
      <div class="row pll prm pbl mtl bg-primary-light">
        <div class="col-lg-9 col-md-8 col-sm-12 col-xs-12 clearfix">
          <h4>Browse schools in <span class="notranslate"><%= city.name  %></span></h4>
          <div class="clearfix">
          <% %w[p e m h].each_with_index do |level, index| %>
            <% css_class = "prl mrm pvm fl" %>
            <div class="<%= css_class %>">
              <%= city.school_browse_link(level) %>
            </div>
          <% end %>
          </div>
          <div class="clearfix">
            <div class="prl mrm pvm fl">
              <!-- Hack, sorry about this. Using array in the link_to param list is the right way, but java search pages cannot handle this. -->
              <%= link_to school_type_display('public') +' schools', search_city_browse_path(:state => @state[:long]
              .downcase.gsub(' ','-'))+'?st=public&st=charter'  %>
            </div>
            <div class="prl mrm pvm fl">
              <%= link_to school_type_display('private') +' schools', search_city_browse_path(:st => 'private',:state =>
                                                                                                           @state[:long].downcase.gsub(' ','-')) %>
            </div>
            <div class="prl mrm pvm fl">
              <%= link_to school_type_display('charter') +' schools', search_city_browse_path(:st => 'charter',:state => @state[:long].downcase.gsub(' ','-')) %>
            </div>
          </div>
        </div>

        <div class="col-lg-3 col-md-4 col-sm-12 col-xs-12 ptm tac">
          <%= city.school_browse_link do %>
            <button class="btn btn-primary mtm mrm fr">View all schools</button>
          <% end %>
        </div>
      </div>
    </div>
    <% if @show_ads %>
      <div class="<%= second_column_sizes %> ptm">
        <div>
          <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Content_Top, view: :desktop  %>
          <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Content_Top, view: :mobile  %>
        </div>
      </div>
    <% end %>
  </div>


  <%= 
    render(
      partial: 'shared/horizontal_school_boxes', 
      locals: { 
        title: "Top rated schools in <span class='notranslate'>#{city.name}</span>",
        schools: SchoolProfileDecorator.decorate_collection(@top_schools),
        ad_no_show: true,
        css_id: 'top-rated-schools-in-city'
      }
    )
  %>

  <% if @show_ads %>

      <div class="pvl">
        <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Text, view: :desktop  %>
        <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Text, view: :mobile  %>
      </div>

  <% end %>

  <% # Row nearby city and Zillow module %>
  <div class="row ptm">
    <% if @districts.present? %>
        <% first_column_sizes = "col-lg-8 col-md-7 col-sm-6" %>
        <% second_column_sizes = "col-lg-4 col-md-5 col-sm-6" %>
    <% else %>
        <% second_column_sizes = "col-lg-12 col-md-12 col-sm-12" %>
    <% end %>

    <%= render partial: 'shared/districts_module', locals: {title: "Largest Districts in <span class='notranslate'>#{city.name}</span>",
                                                            column_size: first_column_sizes, districts: @districts}%>

    <div class="<%= second_column_sizes %>  ma ptm">
      <h3 class="tac">Nearby homes for sale</h3>
      <%= render 'deprecated_school_profile/data_layouts/zillow_content', data: @zillow_data %>
    </div>
  </div>

  <div class="row ptl mtl">
    <div class="col-xs-12">
      <% if @show_ads %>
        <div>
          <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Footer, view: :desktop  %>
          <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Footer, view: :mobile  %>
        </div>
      <% end %>
    </div>
  </div>




  </br>

  <%= render partial: 'shared/email_signup' %>

</div>
