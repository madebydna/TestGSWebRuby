<% bar_chart_collections = data %>
<%= render "shared/section_header", category_placement:category_placement %>

<div class="gs-bootstrap">
  <div class="container-fluid container-fix js-groupComparisonContainer">

    <div class="row">
      <div class='col-xs-12 col-md-4'>
        <%=
          select_tag "group-comparison-chart",
            options_for_select(
              bar_chart_collections.map do | collection |
                [
                  collection.title,
                  class: 'js-dataDisplayCollectionToggle',
                  data: {
                    title: collection.original_data_type,
                    :'event-category'=> 'profile data - subgroup display',
                    :'event-action'=> 'data point toggle',
                    :'event-label' => collection.original_data_type
                  }
                ]
              end
          ),
          class: 'selectpicker',
          data: { width: '100%'}
        %>
      </div>

    <% bar_chart_collections.each_with_index do |bar_chart_collection, i| %>
      <% show_hide_collection = i == 0 ? '' : 'dn' %>
      <div class="js-dataDisplayCollection js-<%= bar_chart_collection.original_data_type %> <%= show_hide_collection %>">
        <%= render partial: 'school_profile/data_viz/bar_chart_breakdowns_dropdown',
          locals: {
            bar_chart_collection: bar_chart_collection,
            bar_chart_collection_index: i,
          }
        %>
      </div>
    <% end %>
    </div>

    <% bar_chart_collections.each_with_index do |bar_chart_collection, i| %>
      <% show_hide_collection = i == 0 ? '' : 'dn' %>
      <% @bar_chart_collection = bar_chart_collection %>
      <%= render partial: 'school_profile/data_viz/bar_chart_collection',
        locals: {bar_chart_collection_index: i,
                 show_hide_collection: show_hide_collection} %>
    <% end %>

    <%= render partial: "shared/partners/promo_delegator",
      locals: {
        promos: Collection.promos_for(@school.collections),
        partial: current_partial,
      }
    %>
  </div>
</div>

<%= render 'school_profile/see_footnotes_link', page_config: @page_config, school: @school, category: category %>

