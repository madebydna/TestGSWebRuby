<% data # A +Hash+ containing data for this table to display %>
<% category_placement # The +CategoryPlacement+ that this table is for %>
<% category # The +Category+ belonging to this table's +CategoryPlacement+ %>

<% data_config = category_placement.table_config %>
<%= debug data if params[:debug] %>
<%= render layout:'col', locals:{ css_class:'', category_placement: category_placement} do %>
    <% data = TableData.new data if !data.is_a? TableData %>

    <a name="<%= category.code_name %>"></a>
    <%= render "shared/section_header", category_placement:category_placement %>


    <%= render "data_layouts/colored_boxes", data: data, category_placement: category_placement, category: category, no_title: true %>

    <table class="table table-striped mhs">
        <% last_key = nil %>
        <% data.rows.each do |row| %>

            <% label = row[:label] %>
            <% value = Array(row[:value]) %>
            <% if value.nil? %>
                <% value = ["na"] %>
            <% end %>
            <tr>
                <td>
                    <% if last_key && last_key == label %>
                    &nbsp;
                    <% else %>

                            <%= label unless label.nil? %>

                    <% end %>
                </td>
                <td>
                    <% value.each do |pretty| %>
                        <%= capitalize_if_string pretty %> <br/>
                    <% end %>
                </td>
            </tr>
            <% last_key = label %>
        <% end %>

    </table>
<% end %>

<%= render partial: 'about_this_data',
  locals: {
    unique_id: category_placement.id,
    descriptions: data.rows.map { |hash| hash[:description] }.uniq.compact
  }
%>