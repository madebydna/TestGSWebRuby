<% state %>

<% cache(["shared/popular_cities_in_state_#{state[:short]}", I18n.locale]) do %>

  <% cities = City.popular_cities(state[:short], limit: 30) %>

  <div class="js-city-list row tal mbl">
      <% state_name_long = state[:long].titleize %>
      <% if state[:short].downcase == 'dc' %>
         <% state_name_long = "Washington DC" %>
      <% end %>
    <h4 style='color: #999999;'><%= t('.find_the_great_schools_in', state_name: state_name_long) %></h4>
    <div class="col-xs-12 col-md-4 col-lg-4">
        <div class="row">
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[0..4].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[5..9].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-md-4 col-lg-4">
        <div class="row">
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[10..14].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[15..19].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
        </div>
    </div>
  
    <div class="col-xs-12 col-md-4 col-lg-4">
        <div class="row">
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[20..24].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-6 col-lg-6">
              <ul>
                <% cities[25..29].try(:each) do |city| %>
                  <li><%= link_to(city.name, city_url(city_params(city.state_long, city.name))) %></li>
                <% end %>
              </ul>
            </div>
        </div>
    </div>
  </div>
<% end %>
  