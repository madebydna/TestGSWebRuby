<% decorator = DetailsOverviewDecorator.new(data, @school, self) %>

<% basic_information = decorator.basic_information %>
<% programs_and_culture = decorator.programs_and_culture %>
<% diversity = decorator.diversity %>


<div id="details-section" class="mtl gs-bootstrap js-overview-details mtl">

  <hr class="thick">
  <% motto = data["Best known for"] %>
  <% if  motto %>
      <%= render 'school_profile/overview/details_overview/principal_motto', motto: motto %>
  <% else %>
      <%= render 'school_profile/overview/details_overview/osp_callout' %>
  <% end %>

  <hr class="thick">
  <div class="container-fluid">
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-lg-8">
        <div class="row">
          <% def display_details_info(info) %>
              <div class="col-xs-12 col-lg-6">
                <h3 class="uc"><%= info.header %></h3>
                <ul class="list-unstyled">
                  <% info.get_data.each_pair do |label, values| %>
                      <li class="mvm">
                        <strong><%= label %></strong>
                        <br/>
                        <%= truncate(values.titleize, length: 60, separator: ', ') %>
                      </li>
                  <% end %>
                </ul>
                <%= link_to info.links.first.first, info.links.first.last %>
              </div>
          <% end %>

          <% if decorator.has_basic_information_data? %>
              <% display_details_info(decorator.basic_information) %>
          <% end %>

          <% if decorator.has_programs_and_culture_data? %>
              <% display_details_info(decorator.programs_and_culture) %>
          <% end %>

          <div class="clearfix visible-lg"></div>

          <% if decorator.has_diversity_data? %>
              <div class="col-lg-12 hidden-xs hidden-sm hidden-md visible-lg">
                <h3 class="uc"><%= diversity.header %></h3>

                <div class="row">
                  <div class="col-lg-6">
                    <strong><%= t('.student_demographics') %></strong>

                    <div class="row">
                      <div class="col-xs-6">
                        <%= render 'school_profile/overview/details_overview/pie_chart',
                                   piedata: diversity.student_diversity,
                                   display: 'desktop'
                        %>
                      </div>
                      <div class="col-xs-6">
                        <%= render 'school_profile/overview/details_overview/ethnicity_table',
                                   data: diversity.student_diversity
                        %>
                      </div>
                    </div>
                  </div>
                  <% if diversity.get_data.count > 0 %> 
                    <div class="col-lg-6">
                      <ul class="list-unstyled">
                        <% diversity.get_data.each_pair do |label, values| %>
                            <div class="mbm">
                              <strong><%= label %>:</strong>
                              <%= values.to_f.round %>%
                            </div>
                        <% end %>
                      </ul>
                      <%= link_to diversity.links.first.first, diversity.links.first.last %>
                    </div>
                <% end  %>
                </div>
              </div>
          <% end %>
        </div>
      </div>
      <% if @show_ads %>
          <div class="col-xs-12 col-sm-4 col-lg-4">
            <div class="mtl">
              <%= render 'layouts/ad_layer', page: @ad_page_name, slot: :Details_Adaptive, defer_render: true, visible_for: ' ' %>
            </div>
          </div>
      <% end %>
      <div class="clearfix hidden-lg"></div>
      <% if decorator.has_diversity_data? %>
          <div class="col-xs-12 col-sm-12 col-md-8 hidden-lg">
            <h3 class="uc"><%= diversity.header %></h3>

            <div class="row">
              <div class="col-xs-12 col-sm-6 hidden-lg">
                <strong><%= t('.student_demographics') %></strong>

                <div class="row">
                  <div class="col-xs-6">
                    <%= render 'school_profile/overview/details_overview/pie_chart',
                               piedata: diversity.student_diversity,
                               display: 'mobile'
                    %>
                  </div>
                  <div class="col-xs-6">
                    <%= render 'school_profile/overview/details_overview/ethnicity_table',
                               data: diversity.student_diversity
                    %>
                  </div>
                </div>
              </div>
              <% if diversity.get_data.count > 0 %> 
                <div class="col-xs-12 col-sm-6 hidden-lg">
                  <ul class="list-unstyled">
                    <% diversity.get_data.each_pair do |label, values| %>
                        <div class="mvm">
                          <strong><%= label %>:</strong>
                          <%= values.to_f.round %>%
                        </div>
                    <% end %>
                  </ul>
                  <%= link_to diversity.links.first.first, diversity.links.first.last %>
                </div>
              <% end  %> 
            </div>
          </div>
      <% end %>
    </div>
  </div>
</div>

