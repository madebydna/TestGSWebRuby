<%
   f; submitted_review;
   principal = @school_user ? @school_user.principal? : false
%>
<% topic_name = question.topic.name %>
<% reviews_for_topic = SchoolProfileReviewsDecorator.decorate(@school_reviews.by_topic[topic_name], self) %>

<div class="topical-review-question-container left">
  <%= render 'deprecated_school_profile/reviews/lib/question_title', question: question %>
  <% if principal %>
      <%= render 'deprecated_school_profile/reviews/modules/output/answer_summary',
                 reviews_for_topic: reviews_for_topic
      %>
  <% else %>
      <%= render 'deprecated_school_profile/reviews/lib/radio_buttons_input',
                 f: f,
                 question: question,
                 submitted_answer: submitted_review.try(:answer)
      %>
  <% end %>
</div>
<% options = {
        comment_required: principal ? true : false,
        principal: principal
} %>
<div class="topical-review-question-container right">
  <% unless options[:comment_required] %>
      <div class="ptl phl <%= principal ? 'dn' : '' %> js-topicalReviewHaveAVoice">
        <% if reviews_for_topic.answer_summary_text.present? %>
            <%= render 'deprecated_school_profile/reviews/modules/output/answer_summary',
                       reviews_for_topic: reviews_for_topic
            %>
        <% else %>
            <%= render 'deprecated_school_profile/reviews/modules/output/have_a_voice' %>
        <% end %>
      </div>
  <% end %>
  <%= render 'deprecated_school_profile/reviews/modules/input/review_comment',
             f: f,
             options: options,
             question: question,
             submitted_review: submitted_review
  %>
</div>
